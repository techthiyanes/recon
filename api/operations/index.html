
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Debug annotated Named Entity Recognition (NER) data for inconsitencies and get insights on improving the quality of your data." name="description"/>
<link href="https://kabirkhan.github.io/recon/api/operations/" rel="canonical"/>
<link href="../../img/favicon.ico" rel="shortcut icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-5.5.1" name="generator"/>
<title>Operations - Recon</title>
<link href="../../assets/stylesheets/main.5d00201e.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.816e8abc.min.css" rel="stylesheet"/>
<meta content="#2196f3" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
<link href="../../css/termynal.css" rel="stylesheet"/>
<link href="../../css/custom.css" rel="stylesheet"/>
<meta content="https://kabirkhan.github.io/recon/api/operations/" property="og:url"/>
<meta content="Operations - Recon" property="og:title"/>
<meta content="Debug annotated Named Entity Recognition (NER) data for inconsitencies and get insights on improving the quality of your data." property="og:description"/>
<meta content="https://microsoft.github.io/reconner/img/recon.svg" property="og:image"/>
<meta content="Recon NER" property="og:image:alt"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@kabir_khan14" name="twitter:site"/>
<meta content="@kabir_khan14" name="twitter:creator"/>
<meta content="Operations - Recon" property="twitter:title"/>
<meta content="Debug annotated Named Entity Recognition (NER) data for inconsitencies and get insights on improving the quality of your data." name="twitter:description"/>
<meta content="https://microsoft.github.io/reconner/img/recon.svg" name="twitter:image"/>
<meta content="Recon NER" name="twitter:image:alt"/>
</head>
<body data-md-color-accent="blue" data-md-color-primary="blue" data-md-color-scheme="" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#recon.operations">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="Recon" class="md-header-nav__button md-logo" href="https://kabirkhan.github.io/recon/" title="Recon">
<img alt="logo" src="../../img/drone-white.svg"/>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            Recon
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              Operations
            
          </span>
</div>
</div>
<div class="md-header-nav__source">
<a class="md-source" href="https://github.com/kabirkhan/recon/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</div>
<div class="md-source__repository">
    kabirkhan/recon
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Recon" class="md-nav__button md-logo" href="https://kabirkhan.github.io/recon/" title="Recon">
<img alt="logo" src="../../img/drone-white.svg"/>
</a>
    Recon
  </label>
<div class="md-nav__source">
<a class="md-source" href="https://github.com/kabirkhan/recon/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</div>
<div class="md-source__repository">
    kabirkhan/recon
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../.." title="Recon">
      Recon
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" id="nav-2" type="checkbox"/>
<label class="md-nav__link" for="nav-2">
      Tutorial
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Tutorial" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-2">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Tutorial
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/1_loading_data/" title="Loading your data">
      Loading your data
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/2_ner_stats/" title="NER Stats">
      NER Stats
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" id="nav-2-3" type="checkbox"/>
<label class="md-nav__link" for="nav-2-3">
      Dataset
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Dataset" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="nav-2-3">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Dataset
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/3_dataset_intro/" title="Introduction">
      Introduction
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/3_dataset_mutate/" title="Making changes to a Dataset">
      Making changes to a Dataset
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/4_corpus/" title="Using a Corpus">
      Using a Corpus
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/4_more_stats/" title="More NER Stats">
      More NER Stats
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/5_getting_insights/" title="Getting Insights">
      Getting Insights
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial/custom_entity_recognizer/" title="Custom EntityRecognizer">
      Custom EntityRecognizer
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="nav-3" id="nav-3" type="checkbox"/>
<label class="md-nav__link" for="nav-3">
      API Reference
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="API Reference" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-3">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        API Reference
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../corpus/" title="Corpus">
      Corpus
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../corrections/" title="Corrections">
      Corrections
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dataset/" title="Dataset">
      Dataset
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hashing/" title="Hashing">
      Hashing
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../insights/" title="Insights">
      Insights
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../loaders/" title="Loaders">
      Loaders
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Operations
        <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"></path></svg>
</span>
</label>
<a class="md-nav__link md-nav__link--active" href="./" title="Operations">
      Operations
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations">
    recon.operations
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations.Operation">
    Operation
  </a>
<nav aria-label="Operation" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations.Operation.__call__">
    __call__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations.Operation.__init__">
    __init__()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations.operation">
    operation
  </a>
<nav aria-label="operation" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations.operation.__call__">
    __call__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations.operation.__init__">
    __init__()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations.op_iter">
    op_iter()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../stats/" title="Stats">
      Stats
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../store/" title="Store">
      Store
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tokenization/" title="Tokenization">
      Tokenization
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../validation/" title="Validation">
      Validation
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-12" id="nav-3-12" type="checkbox"/>
<label class="md-nav__link" for="nav-3-12">
      Recognizers
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Recognizers" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="nav-3-12">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Recognizers
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../recognizers/base/" title="EntityRecognizer">
      EntityRecognizer
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../recognizers/spacy/" title="SpacyEntityRecognizer">
      SpacyEntityRecognizer
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../types/example/" title="Types">
      Types
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../release-notes/" title="Release Notes">
      Release Notes
    </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations">
    recon.operations
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations.Operation">
    Operation
  </a>
<nav aria-label="Operation" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations.Operation.__call__">
    __call__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations.Operation.__init__">
    __init__()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations.operation">
    operation
  </a>
<nav aria-label="operation" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations.operation.__call__">
    __call__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations.operation.__init__">
    __init__()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recon.operations.op_iter">
    op_iter()
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/kabirkhan/recon/tree/master/docs/api/operations.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1>Operations</h1>
<p>Operations are functions that operate on either a list of the examples or a single example.
If the function operates on a single example, Recon will take care of applying it to all examples in a dataset.</p>
<p>The following operations are built into Recon</p>
<!-- `recon.v1.filter_overlaps` -  -->
<div class="admonition error">
<p class="admonition-title">Error</p>
<p>... full list of operations to come</p>
</div>
<div class="doc doc-object doc-module">
<h2 class="hidden-toc" href="#recon.operations" id="recon.operations" style="visibility: hidden; width: 0; height: 0;">
<a class="headerlink" href="#recon.operations" title="Permanent link">¶</a></h2>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="recon.operations.Operation">
<code>Operation</code>
<a class="headerlink" href="#recon.operations.Operation" title="Permanent link">¶</a></h2>
<div class="doc doc-contents">
<p>Operation class that takes care of calling and reporting
the results of an operation on a Dataset</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="recon.operations.Operation.__call__">
<code class="highlight language-python">
__call__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#recon.operations.Operation.__call__" title="Permanent link">¶</a></h3>
<div class="doc doc-contents">
<p>Runs op on a dataset and records the results</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dataset</code></td>
<td><code>Any</code></td>
<td>
<p>Dataset to operate on</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>if track_example is called in the op with no data</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>OperationResult</code></td>
<td>
<p>OperationResult: Container holding new data and the state of the Operation</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>recon/operations.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OperationResult</span><span class="p">:</span>
    <span class="sd">"""Runs op on a dataset and records the results</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (Dataset): Dataset to operate on</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if track_example is called in the op with no data</span>

<span class="sd">    Returns:</span>
<span class="sd">        OperationResult: Container holding new data and the state of the Operation</span>
<span class="sd">    """</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"verbose"</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">initial_state</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"initial_state"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">initial_state</span><span class="p">:</span>
        <span class="n">initial_state</span> <span class="o">=</span> <span class="n">OperationState</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">OperationStatus</span><span class="o">.</span><span class="n">NOT_STARTED</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">OperationStatus</span><span class="o">.</span><span class="n">IN_PROGRESS</span>

    <span class="k">def</span> <span class="nf">add_example</span><span class="p">(</span><span class="n">new_example</span><span class="p">:</span> <span class="n">Example</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">transformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Transformation</span><span class="p">(</span><span class="n">example</span><span class="o">=</span><span class="nb">hash</span><span class="p">(</span><span class="n">new_example</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_ADDED</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">dataset</span><span class="o">.</span><span class="n">example_store</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">transformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Transformation</span><span class="p">(</span>
                <span class="n">prev_example</span><span class="o">=</span><span class="n">orig_example_hash</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_REMOVED</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">change_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_example</span><span class="p">:</span> <span class="n">Example</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">transformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Transformation</span><span class="p">(</span>
                <span class="n">prev_example</span><span class="o">=</span><span class="n">orig_example_hash</span><span class="p">,</span>
                <span class="n">example</span><span class="o">=</span><span class="nb">hash</span><span class="p">(</span><span class="n">new_example</span><span class="p">),</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_CHANGED</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">dataset</span><span class="o">.</span><span class="n">example_store</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>

    <span class="n">has_tokens</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">tokens</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">([(</span><span class="n">s</span><span class="o">.</span><span class="n">token_start</span> <span class="ow">or</span> <span class="n">s</span><span class="o">.</span><span class="n">token_end</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">spans</span><span class="p">]):</span>
            <span class="n">has_tokens</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">has_tokens</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="c1"># fmt: off</span>
            <span class="s2">"This dataset seems to have preset tokens. "</span> <span class="o">+</span>
            <span class="sa">f</span><span class="s2">"Operation: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is not currently capable of handling tokens and you will "</span>
            <span class="s2">"need to reset tokenization after this operation. "</span> <span class="o">+</span>
            <span class="s2">"Applying the `recon.v1.add_tokens` operation after this "</span> <span class="o">+</span>
            <span class="s2">"is complete will get you back to a clean state."</span>
            <span class="c1"># fmt: on</span>
        <span class="p">)</span>

    <span class="n">new_data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">))</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">orig_example_hash</span><span class="p">,</span> <span class="n">example</span><span class="p">,</span> <span class="n">preprocessed_outputs</span> <span class="ow">in</span> <span class="n">op_iter</span><span class="p">(</span>
            <span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">preprocessed_outputs</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(</span>
                    <span class="n">example</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">preprocessed_outputs</span><span class="o">=</span><span class="n">preprocessed_outputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">remove_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">old_example_present</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">new_example</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
                    <span class="n">new_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">hash</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span> <span class="o">==</span> <span class="n">orig_example_hash</span><span class="p">:</span>
                        <span class="n">old_example_present</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">add_example</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">old_example_present</span><span class="p">:</span>
                    <span class="n">remove_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">Example</span><span class="p">)</span>
                <span class="n">new_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">hash</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">!=</span> <span class="n">orig_example_hash</span><span class="p">:</span>
                    <span class="n">change_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>

            <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">transformation_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">type</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">transformations</span><span class="p">])</span>

    <span class="n">state</span><span class="o">.</span><span class="n">examples_added</span> <span class="o">=</span> <span class="n">transformation_counts</span><span class="p">[</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_ADDED</span><span class="p">]</span>
    <span class="n">state</span><span class="o">.</span><span class="n">examples_removed</span> <span class="o">=</span> <span class="n">transformation_counts</span><span class="p">[</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_REMOVED</span><span class="p">]</span>
    <span class="n">state</span><span class="o">.</span><span class="n">examples_changed</span> <span class="o">=</span> <span class="n">transformation_counts</span><span class="p">[</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_CHANGED</span><span class="p">]</span>
    <span class="n">state</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">OperationStatus</span><span class="o">.</span><span class="n">COMPLETED</span>

    <span class="n">state_copy</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">OperationState</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">OperationResult</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">new_data</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">state_copy</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="recon.operations.Operation.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">handles_tokens</span><span class="p">,</span> <span class="n">augmentation</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#recon.operations.Operation.__init__" title="Permanent link">¶</a></h3>
<div class="doc doc-contents">
<p>Initialize an Operation instance</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>
<p>Name of operation</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>pre</code></td>
<td><code>List[recon.preprocess.PreProcessor]</code></td>
<td>
<p>List of preprocessors to run</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>op</code></td>
<td><code>Callable</code></td>
<td>
<p>Decorated function</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>recon/operations.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">pre</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PreProcessor</span><span class="p">],</span>
    <span class="n">op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">handles_tokens</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">augmentation</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">"""Initialize an Operation instance</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): Name of operation</span>
<span class="sd">        pre (List[PreProcessor]): List of preprocessors to run</span>
<span class="sd">        op (Callable): Decorated function</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pre</span> <span class="o">=</span> <span class="n">pre</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">op</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span> <span class="o">=</span> <span class="n">handles_tokens</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span> <span class="o">=</span> <span class="n">augmentation</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="recon.operations.operation">
<code>operation</code>
<a class="headerlink" href="#recon.operations.operation" title="Permanent link">¶</a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="recon.operations.operation.__call__">
<code class="highlight language-python">
__call__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#recon.operations.operation.__call__" title="Permanent link">¶</a></h3>
<div class="doc doc-contents">
<p>Decorator for an operation.
The first arg is the function being decorated.
This function can either operate on a List[Example]
and in that case self.batch should be True.</p>
<p>e.g. @operation("recon.v1.some_name", batch=True)</p>
<p>Or it should operate on a single example and
recon will take care of applying it to a full Dataset</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>args</code></td>
<td><code>Any</code></td>
<td>
<p>First arg is function to decorate</p>
</td>
<td><code>()</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Callable</code></td>
<td>
<p>Callable: Original function</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>recon/operations.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
    <span class="sd">"""Decorator for an operation.</span>
<span class="sd">    The first arg is the function being decorated.</span>
<span class="sd">    This function can either operate on a List[Example]</span>
<span class="sd">    and in that case self.batch should be True.</span>

<span class="sd">    e.g. @operation("recon.v1.some_name", batch=True)</span>

<span class="sd">    Or it should operate on a single example and</span>
<span class="sd">    recon will take care of applying it to a full Dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        args: First arg is function to decorate</span>

<span class="sd">    Returns:</span>
<span class="sd">        Callable: Original function</span>
<span class="sd">    """</span>
    <span class="n">op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">pre</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PreProcessor</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">pre_name_or_op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre</span><span class="p">:</span>
        <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">pre_name_or_op</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">pre_registry</span><span class="o">.</span><span class="n">preprocessors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pre_name_or_op</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">,</span> <span class="n">PreProcessor</span><span class="p">)</span>
        <span class="n">pre</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">factory</span><span class="p">(</span><span class="n">pre</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PreProcessor</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Operation</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Operation</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">pre</span><span class="p">,</span>
                <span class="n">op</span><span class="o">=</span><span class="n">op</span><span class="p">,</span>
                <span class="n">handles_tokens</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span><span class="p">,</span>
                <span class="n">augmentation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">registry</span><span class="o">.</span><span class="n">operation_factories</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)(</span><span class="n">factory</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">registry</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)(</span>
            <span class="n">Operation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span><span class="p">,</span> <span class="n">augmentation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">op</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="recon.operations.operation.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="p">[],</span> <span class="n">handles_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">factory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">augmentation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#recon.operations.operation.__init__" title="Permanent link">¶</a></h3>
<div class="doc doc-contents">
<p>Decorate an operation that makes some changes to a dataset.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>
<p>Operation name.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>pre</code></td>
<td><code>List[Union[str, recon.preprocess.PreProcessor]]</code></td>
<td>
<p>List of preprocessors to run</p>
</td>
<td><code>[]</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>recon/operations.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">pre</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PreProcessor</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">handles_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">factory</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">augmentation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">"""Decorate an operation that makes some changes to a dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): Operation name.</span>
<span class="sd">        pre (Union[List[str], List[PreProcessor]]): List of preprocessors to run</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pre</span> <span class="o">=</span> <span class="n">pre</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span> <span class="o">=</span> <span class="n">handles_tokens</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">factory</span> <span class="o">=</span> <span class="n">factory</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span> <span class="o">=</span> <span class="n">augmentation</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="recon.operations.op_iter">
<code class="highlight language-python">
op_iter<span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> </code>
<a class="headerlink" href="#recon.operations.op_iter" title="Permanent link">¶</a></h2>
<div class="doc doc-contents">
<p>Iterate over list of examples for an operation
yielding tuples of (example hash, example)</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>data</code></td>
<td><code>List[recon.types.Example]</code></td>
<td>
<p>List of examples to iterate</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>pre</code></td>
<td><code>List[recon.preprocess.PreProcessor]</code></td>
<td>
<p>List of preprocessors to run</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>bool</code></td>
<td>
<p>Show verbose output.</p>
</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
<div class="admonition yields">
<p class="admonition-title">Yields</p>
<p>Iterator[Tuple[int, Example]]: Tuples of (example hash, example)</p>
</div>
<details class="quote">
<summary>Source code in <code>recon/operations.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">op_iter</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Example</span><span class="p">],</span> <span class="n">pre</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PreProcessor</span><span class="p">],</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Example</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
    <span class="sd">"""Iterate over list of examples for an operation</span>
<span class="sd">    yielding tuples of (example hash, example)</span>

<span class="sd">    Args:</span>
<span class="sd">        data (List[Example]): List of examples to iterate</span>
<span class="sd">        pre (List[PreProcessor]): List of preprocessors to run</span>
<span class="sd">        verbose (bool, optional): Show verbose output.</span>

<span class="sd">    Yields:</span>
<span class="sd">        Iterator[Tuple[int, Example]]: Tuples of (example hash, example)</span>
<span class="sd">    """</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">Printer</span><span class="p">(</span><span class="n">no_print</span><span class="o">=</span><span class="n">verbose</span> <span class="o">==</span> <span class="kc">False</span><span class="p">,</span> <span class="n">hide_animation</span><span class="o">=</span><span class="n">verbose</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">preprocessed_outputs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Example</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">processor</span> <span class="ow">in</span> <span class="n">pre</span><span class="p">:</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\t</span><span class="s2">=&gt; Running preprocessor </span><span class="si">{</span><span class="n">processor</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">processor_outputs</span> <span class="o">=</span> <span class="n">processor</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">example</span><span class="p">,</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">processor_outputs</span><span class="p">),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">):</span>
            <span class="n">preprocessed_outputs</span><span class="p">[</span><span class="n">example</span><span class="p">][</span><span class="n">processor</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span>
            <span class="n">example</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">processor</span><span class="o">.</span><span class="n">field</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">yield</span> <span class="nb">hash</span><span class="p">(</span><span class="n">example</span><span class="p">),</span> <span class="n">example</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">preprocessed_outputs</span><span class="p">[</span><span class="n">example</span><span class="p">]</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="../loaders/" rel="prev" title="Loaders">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Loaders
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../stats/" rel="next" title="Stats">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Stats
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
<div class="md-footer-social">
<a class="md-footer-social__link" href="https://github.com/kabirkhan/recon" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</a>
<a class="md-footer-social__link" href="https://twitter.com/kabir_khan14" rel="noopener" target="_blank" title="twitter.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<script src="../../assets/javascripts/vendor.592d4e23.min.js"></script>
<script src="../../assets/javascripts/bundle.073197b2.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
<script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.01088dc6.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
<script src="../../js/termynal.js"></script>
<script src="https://unpkg.com/mermaid@8.4.6/dist/mermaid.min.js"></script>
<script src="../../js/custom.js"></script>
</body>
</html>