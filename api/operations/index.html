



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Debug annotated Named Entity Recognition (NER) data for inconsitencies and get insights on improving the quality of your data.">
      
      
        <link rel="canonical" href="https://kabirkhan.github.io/recon/api/operations/">
      
      
      <link rel="shortcut icon" href="../../img/recon.svg">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-5.5.14">
    
    
      
        <title>Operations - Recon</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.d3202873.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ff0a5ce4.min.css">
      
      
        
        
        <meta name="theme-color" content="#ffffff">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/termynal.css">
    
      <link rel="stylesheet" href="../../css/custom.css">
    
    
      
    
    

  <meta property="og:url" content="https://kabirkhan.github.io/recon/api/operations/">
  
    <meta property="og:title" content="Operations - Recon">
  
  <meta property="og:description" content="Debug annotated Named Entity Recognition (NER) data for inconsitencies and get insights on improving the quality of your data.">
  <meta property="og:image" content="https://microsoft.github.io/reconner/img/recon.svg">
  <meta property="og:image:alt" content="Recon NER">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@kabir_khan14">
  <meta name="twitter:creator" content="@kabir_khan14">
  
    <meta property="twitter:title" content="Operations - Recon">
  
  <meta name="twitter:description" content="Debug annotated Named Entity Recognition (NER) data for inconsitencies and get insights on improving the quality of your data.">
  <meta name="twitter:image" content="https://microsoft.github.io/reconner/img/recon.svg">
  <meta name="twitter:image:alt" content="Recon NER">


  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="white" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#recon.operations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://kabirkhan.github.io/recon/" title="Recon" class="md-header-nav__button md-logo" aria-label="Recon">
      
  <img src="../../img/recon.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Recon
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Operations
            
          </span>
        </div>
      
    </div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/kabirkhan/recon" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    kabirkhan/recon
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://kabirkhan.github.io/recon/" title="Recon" class="md-nav__button md-logo" aria-label="Recon">
      
  <img src="../../img/recon.svg" alt="logo">

    </a>
    Recon
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/kabirkhan/recon" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    kabirkhan/recon
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Recon" class="md-nav__link">
      Recon
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Tutorial
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Tutorial" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/1_loading_data/" title="Loading your data" class="md-nav__link">
      Loading your data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/2_ner_stats/" title="NER Stats" class="md-nav__link">
      NER Stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Dataset
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Dataset" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        <span class="md-nav__icon md-icon"></span>
        Dataset
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/3_dataset_intro/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/3_dataset_mutate/" title="Making changes to a Dataset" class="md-nav__link">
      Making changes to a Dataset
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/4_corpus/" title="Using a Corpus" class="md-nav__link">
      Using a Corpus
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/4_more_stats/" title="More NER Stats" class="md-nav__link">
      More NER Stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/5_getting_insights/" title="Getting Insights" class="md-nav__link">
      Getting Insights
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/custom_entity_recognizer/" title="Custom EntityRecognizer" class="md-nav__link">
      Custom EntityRecognizer
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      API Reference
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="API Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        API Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../corpus/" title="Corpus" class="md-nav__link">
      Corpus
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../corrections/" title="Corrections" class="md-nav__link">
      Corrections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dataset/" title="Dataset" class="md-nav__link">
      Dataset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hashing/" title="Hashing" class="md-nav__link">
      Hashing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../insights/" title="Insights" class="md-nav__link">
      Insights
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../loaders/" title="Loaders" class="md-nav__link">
      Loaders
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Operations
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" title="Operations" class="md-nav__link md-nav__link--active">
      Operations
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#recon.operations" class="md-nav__link">
    recon.operations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recon.operations.core" class="md-nav__link">
    core
  </a>
  
    <nav class="md-nav" aria-label="core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon.operations.core.Operation" class="md-nav__link">
    Operation
  </a>
  
    <nav class="md-nav" aria-label="Operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon.operations.core.Operation.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.core.Operation.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.core.operation" class="md-nav__link">
    operation
  </a>
  
    <nav class="md-nav" aria-label="operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon.operations.core.operation.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.core.operation.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.core.op_iter" class="md-nav__link">
    op_iter()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recon.operations.corrections" class="md-nav__link">
    corrections
  </a>
  
    <nav class="md-nav" aria-label="corrections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon.operations.corrections.corrections_from_dict" class="md-nav__link">
    corrections_from_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.corrections.fix_annotations" class="md-nav__link">
    fix_annotations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.corrections.rename_labels" class="md-nav__link">
    rename_labels()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.corrections.split_sentences" class="md-nav__link">
    split_sentences()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.corrections.strip_annotations" class="md-nav__link">
    strip_annotations()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recon.operations.tokenization" class="md-nav__link">
    tokenization
  </a>
  
    <nav class="md-nav" aria-label="tokenization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon.operations.tokenization.add_tokens" class="md-nav__link">
    add_tokens()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.tokenization.fix_tokenization_and_spacing" class="md-nav__link">
    fix_tokenization_and_spacing()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recon.operations.utils" class="md-nav__link">
    utils
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon.operations.utils.create_response_field" class="md-nav__link">
    create_response_field()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.utils.get_received_operation_data" class="md-nav__link">
    get_received_operation_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.utils.get_required_operation_params" class="md-nav__link">
    get_required_operation_params()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recon.operations.validation" class="md-nav__link">
    validation
  </a>
  
    <nav class="md-nav" aria-label="validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon.operations.validation.filter_overlaps" class="md-nav__link">
    filter_overlaps()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.validation.remove_overlapping_entities" class="md-nav__link">
    remove_overlapping_entities()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.validation.select_subset_of_overlapping_chain" class="md-nav__link">
    select_subset_of_overlapping_chain()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.validation.upcase_labels" class="md-nav__link">
    upcase_labels()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../stats/" title="Stats" class="md-nav__link">
      Stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../store/" title="Store" class="md-nav__link">
      Store
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tokenization/" title="Tokenization" class="md-nav__link">
      Tokenization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../validation/" title="Validation" class="md-nav__link">
      Validation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-12" type="checkbox" id="nav-3-12">
    
    <label class="md-nav__link" for="nav-3-12">
      Recognizers
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Recognizers" data-md-level="2">
      <label class="md-nav__title" for="nav-3-12">
        <span class="md-nav__icon md-icon"></span>
        Recognizers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../recognizers/base/" title="EntityRecognizer" class="md-nav__link">
      EntityRecognizer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../recognizers/spacy/" title="SpacyEntityRecognizer" class="md-nav__link">
      SpacyEntityRecognizer
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../types/example/" title="Types" class="md-nav__link">
      Types
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#recon.operations" class="md-nav__link">
    recon.operations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recon.operations.core" class="md-nav__link">
    core
  </a>
  
    <nav class="md-nav" aria-label="core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon.operations.core.Operation" class="md-nav__link">
    Operation
  </a>
  
    <nav class="md-nav" aria-label="Operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon.operations.core.Operation.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.core.Operation.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.core.operation" class="md-nav__link">
    operation
  </a>
  
    <nav class="md-nav" aria-label="operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon.operations.core.operation.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.core.operation.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.core.op_iter" class="md-nav__link">
    op_iter()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recon.operations.corrections" class="md-nav__link">
    corrections
  </a>
  
    <nav class="md-nav" aria-label="corrections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon.operations.corrections.corrections_from_dict" class="md-nav__link">
    corrections_from_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.corrections.fix_annotations" class="md-nav__link">
    fix_annotations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.corrections.rename_labels" class="md-nav__link">
    rename_labels()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.corrections.split_sentences" class="md-nav__link">
    split_sentences()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.corrections.strip_annotations" class="md-nav__link">
    strip_annotations()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recon.operations.tokenization" class="md-nav__link">
    tokenization
  </a>
  
    <nav class="md-nav" aria-label="tokenization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon.operations.tokenization.add_tokens" class="md-nav__link">
    add_tokens()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.tokenization.fix_tokenization_and_spacing" class="md-nav__link">
    fix_tokenization_and_spacing()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recon.operations.utils" class="md-nav__link">
    utils
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon.operations.utils.create_response_field" class="md-nav__link">
    create_response_field()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.utils.get_received_operation_data" class="md-nav__link">
    get_received_operation_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.utils.get_required_operation_params" class="md-nav__link">
    get_required_operation_params()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recon.operations.validation" class="md-nav__link">
    validation
  </a>
  
    <nav class="md-nav" aria-label="validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon.operations.validation.filter_overlaps" class="md-nav__link">
    filter_overlaps()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.validation.remove_overlapping_entities" class="md-nav__link">
    remove_overlapping_entities()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.validation.select_subset_of_overlapping_chain" class="md-nav__link">
    select_subset_of_overlapping_chain()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon.operations.validation.upcase_labels" class="md-nav__link">
    upcase_labels()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/kabirkhan/recon/tree/master/docs/api/operations.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                  <h1>Operations</h1>
                
                <p>Operations are functions that operate on either a list of the examples or a single example.
If the function operates on a single example, Recon will take care of applying it to all examples in a dataset.</p>
<p>The following operations are built into Recon</p>
<!-- `recon.v1.filter_overlaps` -  -->
<div class="admonition error">
<p class="admonition-title">Error</p>
<p>... full list of operations to come</p>
</div>


  <div class="doc doc-object doc-module">

<a id="recon.operations"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">











  <div class="doc doc-object doc-module">



<h2 id="recon.operations.core" class="doc doc-heading">
        <code>core</code>



<a href="#recon.operations.core" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="recon.operations.core.Operation" class="doc doc-heading">
        <code>
Operation        </code>



<a href="#recon.operations.core.Operation" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Operation class that takes care of calling and reporting
the results of an operation on a Dataset</p>

        <details class="quote">
          <summary>Source code in <code>recon/operations/core.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Operation</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Operation class that takes care of calling and reporting</span>
<span class="sd">    the results of an operation on a Dataset&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">pre</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PreProcessor</span><span class="p">],</span>
        <span class="n">op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
        <span class="n">handles_tokens</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">augmentation</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize an Operation instance</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): Name of operation</span>
<span class="sd">            pre (List[PreProcessor]): List of preprocessors to run</span>
<span class="sd">            op (Op): Operation callable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pre</span> <span class="o">=</span> <span class="n">pre</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">op</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span> <span class="o">=</span> <span class="n">handles_tokens</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span> <span class="o">=</span> <span class="n">augmentation</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">OperationState</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OperationResult</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Runs op on a dataset and records the results</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset (Dataset): Dataset to operate on</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if track_example is called in the op with no data</span>

<span class="sd">        Returns:</span>
<span class="sd">            OperationResult: Container holding new data and the state of the Operation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">initial_state</span><span class="p">:</span>
            <span class="n">initial_state</span> <span class="o">=</span> <span class="n">OperationState</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">OperationStatus</span><span class="o">.</span><span class="n">NOT_STARTED</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">OperationStatus</span><span class="o">.</span><span class="n">IN_PROGRESS</span>

        <span class="n">state</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
        <span class="n">state</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="k">def</span> <span class="nf">add_example</span><span class="p">(</span><span class="n">new_example</span><span class="p">:</span> <span class="n">Example</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">transformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Transformation</span><span class="p">(</span><span class="n">example</span><span class="o">=</span><span class="nb">hash</span><span class="p">(</span><span class="n">new_example</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_ADDED</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">dataset</span><span class="o">.</span><span class="n">example_store</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">remove_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">transformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Transformation</span><span class="p">(</span><span class="n">prev_example</span><span class="o">=</span><span class="n">orig_example_hash</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_REMOVED</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">def</span> <span class="nf">change_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_example</span><span class="p">:</span> <span class="n">Example</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">transformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Transformation</span><span class="p">(</span>
                    <span class="n">prev_example</span><span class="o">=</span><span class="n">orig_example_hash</span><span class="p">,</span>
                    <span class="n">example</span><span class="o">=</span><span class="nb">hash</span><span class="p">(</span><span class="n">new_example</span><span class="p">),</span>
                    <span class="nb">type</span><span class="o">=</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_CHANGED</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">dataset</span><span class="o">.</span><span class="n">example_store</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>

        <span class="n">has_tokens</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">tokens</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">([(</span><span class="n">s</span><span class="o">.</span><span class="n">token_start</span> <span class="ow">or</span> <span class="n">s</span><span class="o">.</span><span class="n">token_end</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">spans</span><span class="p">]):</span>
                <span class="n">has_tokens</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">has_tokens</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="c1"># fmt: off</span>
                <span class="s2">&quot;This dataset seems to have preset tokens. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Operation: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is not currently capable of handling tokens and you will &quot;</span>
                <span class="s2">&quot;need to reset tokenization after this operation. &quot;</span>
                <span class="s2">&quot;Applying the `recon.v1.add_tokens` operation after this &quot;</span>
                <span class="s2">&quot;operation is complete will get you back to a clean state.&quot;</span>
                <span class="c1"># fmt: on</span>
            <span class="p">)</span>

        <span class="n">required_params</span> <span class="o">=</span> <span class="n">get_required_operation_params</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">)</span>
        <span class="n">received_data</span> <span class="o">=</span> <span class="n">get_received_operation_data</span><span class="p">(</span><span class="n">required_params</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="n">values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ErrorWrapper</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">received_data</span><span class="p">:</span>
            <span class="n">values</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">request_body_to_args</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">required_params</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">received_data</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Validation error while trying to call operation: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;with provided args and kwargs values. &quot;</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">errors</span><span class="p">:</span>
                <span class="n">error_msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">exc</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

        <span class="n">state</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">state</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">values</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">))</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">orig_example_hash</span><span class="p">,</span> <span class="n">example</span><span class="p">,</span> <span class="n">preprocessed_outputs</span> <span class="ow">in</span> <span class="n">op_iter</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">preprocessed_outputs</span><span class="p">:</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">preprocessed_outputs</span><span class="o">=</span><span class="n">preprocessed_outputs</span><span class="p">,</span> <span class="o">**</span><span class="n">values</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="o">**</span><span class="n">values</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">remove_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">old_example_present</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">for</span> <span class="n">new_example</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
                        <span class="n">new_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">hash</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span> <span class="o">==</span> <span class="n">orig_example_hash</span><span class="p">:</span>
                            <span class="n">old_example_present</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">add_example</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">old_example_present</span><span class="p">:</span>
                        <span class="n">remove_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">Example</span><span class="p">)</span>
                    <span class="n">new_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">hash</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">!=</span> <span class="n">orig_example_hash</span><span class="p">:</span>
                        <span class="n">change_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>

                <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">transformation_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">type</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">transformations</span><span class="p">])</span>

        <span class="n">state</span><span class="o">.</span><span class="n">examples_added</span> <span class="o">=</span> <span class="n">transformation_counts</span><span class="p">[</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_ADDED</span><span class="p">]</span>
        <span class="n">state</span><span class="o">.</span><span class="n">examples_removed</span> <span class="o">=</span> <span class="n">transformation_counts</span><span class="p">[</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_REMOVED</span><span class="p">]</span>
        <span class="n">state</span><span class="o">.</span><span class="n">examples_changed</span> <span class="o">=</span> <span class="n">transformation_counts</span><span class="p">[</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_CHANGED</span><span class="p">]</span>
        <span class="n">state</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">OperationStatus</span><span class="o">.</span><span class="n">COMPLETED</span>

        <span class="n">state_copy</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">OperationState</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">OperationResult</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">new_data</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">state_copy</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">op_registry</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="recon.operations.core.Operation.__call__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#recon.operations.core.Operation.__call__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Runs op on a dataset and records the results</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset</code></td>
        <td><code>Dataset</code></td>
        <td><p>Dataset to operate on</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if track_example is called in the op with no data</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>OperationResult</code></td>
      <td><p>Container holding new data and the state of the Operation</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/core.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">OperationState</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OperationResult</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Runs op on a dataset and records the results</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (Dataset): Dataset to operate on</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if track_example is called in the op with no data</span>

<span class="sd">    Returns:</span>
<span class="sd">        OperationResult: Container holding new data and the state of the Operation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">initial_state</span><span class="p">:</span>
        <span class="n">initial_state</span> <span class="o">=</span> <span class="n">OperationState</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">OperationStatus</span><span class="o">.</span><span class="n">NOT_STARTED</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">OperationStatus</span><span class="o">.</span><span class="n">IN_PROGRESS</span>

    <span class="n">state</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
    <span class="n">state</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

    <span class="k">def</span> <span class="nf">add_example</span><span class="p">(</span><span class="n">new_example</span><span class="p">:</span> <span class="n">Example</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">transformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Transformation</span><span class="p">(</span><span class="n">example</span><span class="o">=</span><span class="nb">hash</span><span class="p">(</span><span class="n">new_example</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_ADDED</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">dataset</span><span class="o">.</span><span class="n">example_store</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">transformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Transformation</span><span class="p">(</span><span class="n">prev_example</span><span class="o">=</span><span class="n">orig_example_hash</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_REMOVED</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">change_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_example</span><span class="p">:</span> <span class="n">Example</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">transformations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Transformation</span><span class="p">(</span>
                <span class="n">prev_example</span><span class="o">=</span><span class="n">orig_example_hash</span><span class="p">,</span>
                <span class="n">example</span><span class="o">=</span><span class="nb">hash</span><span class="p">(</span><span class="n">new_example</span><span class="p">),</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_CHANGED</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">dataset</span><span class="o">.</span><span class="n">example_store</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>

    <span class="n">has_tokens</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">tokens</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">([(</span><span class="n">s</span><span class="o">.</span><span class="n">token_start</span> <span class="ow">or</span> <span class="n">s</span><span class="o">.</span><span class="n">token_end</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">spans</span><span class="p">]):</span>
            <span class="n">has_tokens</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">has_tokens</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="c1"># fmt: off</span>
            <span class="s2">&quot;This dataset seems to have preset tokens. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Operation: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is not currently capable of handling tokens and you will &quot;</span>
            <span class="s2">&quot;need to reset tokenization after this operation. &quot;</span>
            <span class="s2">&quot;Applying the `recon.v1.add_tokens` operation after this &quot;</span>
            <span class="s2">&quot;operation is complete will get you back to a clean state.&quot;</span>
            <span class="c1"># fmt: on</span>
        <span class="p">)</span>

    <span class="n">required_params</span> <span class="o">=</span> <span class="n">get_required_operation_params</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">)</span>
    <span class="n">received_data</span> <span class="o">=</span> <span class="n">get_received_operation_data</span><span class="p">(</span><span class="n">required_params</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

    <span class="n">values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">errors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ErrorWrapper</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">received_data</span><span class="p">:</span>
        <span class="n">values</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">request_body_to_args</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">required_params</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">received_data</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Validation error while trying to call operation: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;with provided args and kwargs values. &quot;</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">errors</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">exc</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

    <span class="n">state</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">state</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">values</span>
    <span class="n">new_data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">))</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">orig_example_hash</span><span class="p">,</span> <span class="n">example</span><span class="p">,</span> <span class="n">preprocessed_outputs</span> <span class="ow">in</span> <span class="n">op_iter</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">preprocessed_outputs</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">preprocessed_outputs</span><span class="o">=</span><span class="n">preprocessed_outputs</span><span class="p">,</span> <span class="o">**</span><span class="n">values</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="o">**</span><span class="n">values</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">remove_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">old_example_present</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">new_example</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
                    <span class="n">new_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">hash</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span> <span class="o">==</span> <span class="n">orig_example_hash</span><span class="p">:</span>
                        <span class="n">old_example_present</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">add_example</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">old_example_present</span><span class="p">:</span>
                    <span class="n">remove_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">Example</span><span class="p">)</span>
                <span class="n">new_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">hash</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">!=</span> <span class="n">orig_example_hash</span><span class="p">:</span>
                    <span class="n">change_example</span><span class="p">(</span><span class="n">orig_example_hash</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>

            <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">transformation_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">type</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">transformations</span><span class="p">])</span>

    <span class="n">state</span><span class="o">.</span><span class="n">examples_added</span> <span class="o">=</span> <span class="n">transformation_counts</span><span class="p">[</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_ADDED</span><span class="p">]</span>
    <span class="n">state</span><span class="o">.</span><span class="n">examples_removed</span> <span class="o">=</span> <span class="n">transformation_counts</span><span class="p">[</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_REMOVED</span><span class="p">]</span>
    <span class="n">state</span><span class="o">.</span><span class="n">examples_changed</span> <span class="o">=</span> <span class="n">transformation_counts</span><span class="p">[</span><span class="n">TransformationType</span><span class="o">.</span><span class="n">EXAMPLE_CHANGED</span><span class="p">]</span>
    <span class="n">state</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">OperationStatus</span><span class="o">.</span><span class="n">COMPLETED</span>

    <span class="n">state_copy</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">OperationState</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">OperationResult</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">new_data</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">state_copy</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="recon.operations.core.Operation.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">handles_tokens</span><span class="p">,</span> <span class="n">augmentation</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#recon.operations.core.Operation.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Initialize an Operation instance</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>Name of operation</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>pre</code></td>
        <td><code>List[PreProcessor]</code></td>
        <td><p>List of preprocessors to run</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>op</code></td>
        <td><code>Op</code></td>
        <td><p>Operation callable</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/core.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">pre</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PreProcessor</span><span class="p">],</span>
    <span class="n">op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">handles_tokens</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">augmentation</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize an Operation instance</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): Name of operation</span>
<span class="sd">        pre (List[PreProcessor]): List of preprocessors to run</span>
<span class="sd">        op (Op): Operation callable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pre</span> <span class="o">=</span> <span class="n">pre</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">op</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span> <span class="o">=</span> <span class="n">handles_tokens</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span> <span class="o">=</span> <span class="n">augmentation</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="recon.operations.core.operation" class="doc doc-heading">
        <code>
operation        </code>



<a href="#recon.operations.core.operation" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>recon/operations/core.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">operation</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">pre</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PreProcessor</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">handles_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">factory</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">augmentation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Decorate an operation that makes some changes to a dataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): Operation name.</span>
<span class="sd">            pre (Union[List[str], List[PreProcessor]]): List of preprocessors to run</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pre</span> <span class="o">=</span> <span class="n">pre</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span> <span class="o">=</span> <span class="n">handles_tokens</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span> <span class="o">=</span> <span class="n">factory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span> <span class="o">=</span> <span class="n">augmentation</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">Op</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Decorator for an operation.</span>
<span class="sd">        The first arg is the function being decorated.</span>
<span class="sd">        This function can either operate on a List[Example]</span>
<span class="sd">        and in that case self.batch should be True.</span>

<span class="sd">        e.g. @operation(&quot;recon.v1.some_name&quot;, batch=True)</span>

<span class="sd">        Or it should operate on a single example and</span>
<span class="sd">        recon will take care of applying it to a full Dataset</span>

<span class="sd">        Args:</span>
<span class="sd">            op (Op): First arg is callable to decorate</span>

<span class="sd">        Returns:</span>
<span class="sd">            Op: Original operation callable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pre</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PreProcessor</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">pre_name_or_op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre</span><span class="p">:</span>
            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">pre_name_or_op</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">pre_registry</span><span class="o">.</span><span class="n">preprocessors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pre_name_or_op</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">,</span> <span class="n">PreProcessor</span><span class="p">)</span>
            <span class="n">pre</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">factory</span><span class="p">(</span><span class="n">pre</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PreProcessor</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Operation</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Operation</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">pre</span><span class="p">,</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">op</span><span class="p">,</span>
                    <span class="n">handles_tokens</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span><span class="p">,</span>
                    <span class="n">augmentation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span>
                <span class="p">)</span>

            <span class="n">op_registry</span><span class="o">.</span><span class="n">operation_factories</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)(</span><span class="n">factory</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">op_registry</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)(</span>
                <span class="n">Operation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span><span class="p">,</span> <span class="n">augmentation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">op</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="recon.operations.core.operation.__call__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#recon.operations.core.operation.__call__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Decorator for an operation.
The first arg is the function being decorated.
This function can either operate on a List[Example]
and in that case self.batch should be True.</p>
<p>e.g. @operation("recon.v1.some_name", batch=True)</p>
<p>Or it should operate on a single example and
recon will take care of applying it to a full Dataset</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>op</code></td>
        <td><code>Op</code></td>
        <td><p>First arg is callable to decorate</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Op</code></td>
      <td><p>Original operation callable</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/core.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">Op</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Decorator for an operation.</span>
<span class="sd">    The first arg is the function being decorated.</span>
<span class="sd">    This function can either operate on a List[Example]</span>
<span class="sd">    and in that case self.batch should be True.</span>

<span class="sd">    e.g. @operation(&quot;recon.v1.some_name&quot;, batch=True)</span>

<span class="sd">    Or it should operate on a single example and</span>
<span class="sd">    recon will take care of applying it to a full Dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        op (Op): First arg is callable to decorate</span>

<span class="sd">    Returns:</span>
<span class="sd">        Op: Original operation callable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pre</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PreProcessor</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">pre_name_or_op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre</span><span class="p">:</span>
        <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">pre_name_or_op</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">pre_registry</span><span class="o">.</span><span class="n">preprocessors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pre_name_or_op</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">,</span> <span class="n">PreProcessor</span><span class="p">)</span>
        <span class="n">pre</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">factory</span><span class="p">(</span><span class="n">pre</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PreProcessor</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Operation</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Operation</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">pre</span><span class="p">,</span>
                <span class="n">op</span><span class="o">=</span><span class="n">op</span><span class="p">,</span>
                <span class="n">handles_tokens</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span><span class="p">,</span>
                <span class="n">augmentation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span>
            <span class="p">)</span>

        <span class="n">op_registry</span><span class="o">.</span><span class="n">operation_factories</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)(</span><span class="n">factory</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">op_registry</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)(</span>
            <span class="n">Operation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span><span class="p">,</span> <span class="n">augmentation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">op</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="recon.operations.core.operation.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="p">[],</span> <span class="n">handles_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">factory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">augmentation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#recon.operations.core.operation.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Decorate an operation that makes some changes to a dataset.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>Operation name.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>pre</code></td>
        <td><code>Union[List[str], List[PreProcessor]]</code></td>
        <td><p>List of preprocessors to run</p></td>
        <td><code>[]</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/core.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">pre</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PreProcessor</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">handles_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">factory</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">augmentation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Decorate an operation that makes some changes to a dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): Operation name.</span>
<span class="sd">        pre (Union[List[str], List[PreProcessor]]): List of preprocessors to run</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pre</span> <span class="o">=</span> <span class="n">pre</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">handles_tokens</span> <span class="o">=</span> <span class="n">handles_tokens</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">factory</span> <span class="o">=</span> <span class="n">factory</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span> <span class="o">=</span> <span class="n">augmentation</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="recon.operations.core.op_iter" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">op_iter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#recon.operations.core.op_iter" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Iterate over list of examples for an operation
yielding tuples of (example hash, example)</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>List[Example]</code></td>
        <td><p>List of examples to iterate</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>pre</code></td>
        <td><code>List[PreProcessor]</code></td>
        <td><p>List of preprocessors to run</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>Show verbose output.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Yields:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Iterator[Tuple[int, Example]]</code></td>
      <td><p>Tuples of (example hash, example)</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/core.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">op_iter</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Example</span><span class="p">],</span> <span class="n">pre</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PreProcessor</span><span class="p">],</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Example</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
    <span class="sd">&quot;&quot;&quot;Iterate over list of examples for an operation</span>
<span class="sd">    yielding tuples of (example hash, example)</span>

<span class="sd">    Args:</span>
<span class="sd">        data (List[Example]): List of examples to iterate</span>
<span class="sd">        pre (List[PreProcessor]): List of preprocessors to run</span>
<span class="sd">        verbose (bool, optional): Show verbose output.</span>

<span class="sd">    Yields:</span>
<span class="sd">        Iterator[Tuple[int, Example]]: Tuples of (example hash, example)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">Printer</span><span class="p">(</span><span class="n">no_print</span><span class="o">=</span><span class="n">verbose</span> <span class="o">==</span> <span class="kc">False</span><span class="p">,</span> <span class="n">hide_animation</span><span class="o">=</span><span class="n">verbose</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">preprocessed_outputs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Example</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">processor</span> <span class="ow">in</span> <span class="n">pre</span><span class="p">:</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">=&gt; Running preprocessor </span><span class="si">{</span><span class="n">processor</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">processor_outputs</span> <span class="o">=</span> <span class="n">processor</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">example</span><span class="p">,</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">processor_outputs</span><span class="p">),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="n">preprocessed_outputs</span><span class="p">[</span><span class="n">example</span><span class="p">][</span><span class="n">processor</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span>
            <span class="n">example</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">processor</span><span class="o">.</span><span class="n">field</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">yield</span> <span class="nb">hash</span><span class="p">(</span><span class="n">example</span><span class="p">),</span> <span class="n">example</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">preprocessed_outputs</span><span class="p">[</span><span class="n">example</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="recon.operations.corrections" class="doc doc-heading">
        <code>corrections</code>



<a href="#recon.operations.corrections" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Make corrections to your data.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h3 id="recon.operations.corrections.corrections_from_dict" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">corrections_from_dict</span><span class="p">(</span><span class="n">corrections_dict</span><span class="p">)</span></code>


<a href="#recon.operations.corrections.corrections_from_dict" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Create a list of Correction objects from a simpler config for
corrections using a Dict representation mapping keys to either the label to
convert to or a tuple of (from_label, to_label) pairings or (List[from_labels], to_label)
pairings if you want to convert as subset of labels at a time</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>corrections_dict</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>Corrections formatted dict
e.g. {
    "united states": "GPE",
    "London": (["LOC"], "GPE")
}</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the format of the dict</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>[type]</code></td>
      <td><p>[description]</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/corrections.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">corrections_from_dict</span><span class="p">(</span><span class="n">corrections_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Correction</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Create a list of Correction objects from a simpler config for</span>
<span class="sd">    corrections using a Dict representation mapping keys to either the label to</span>
<span class="sd">    convert to or a tuple of (from_label, to_label) pairings or (List[from_labels], to_label)</span>
<span class="sd">    pairings if you want to convert as subset of labels at a time</span>

<span class="sd">    Args:</span>
<span class="sd">        corrections_dict (Dict[str, Any]): Corrections formatted dict</span>
<span class="sd">            e.g. {</span>
<span class="sd">                &quot;united states&quot;: &quot;GPE&quot;,</span>
<span class="sd">                &quot;London&quot;: ([&quot;LOC&quot;], &quot;GPE&quot;)</span>
<span class="sd">            }</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the format of the dict</span>

<span class="sd">    Returns:</span>
<span class="sd">        [type]: [description]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">corrections</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Correction</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">corrections_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">from_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ANY&quot;</span><span class="p">]</span>
            <span class="n">to_label</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">from_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">from_labels</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">to_label</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot parse corrections dict. Value must be either a str of the label &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;to change the annotation to (TO_LABEL) or a tuple of (FROM_LABEL, TO_LABEL)&quot;</span>
            <span class="p">)</span>
        <span class="n">corrections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Correction</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">from_labels</span><span class="o">=</span><span class="n">from_labels</span><span class="p">,</span> <span class="n">to_label</span><span class="o">=</span><span class="n">to_label</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">corrections</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="recon.operations.corrections.fix_annotations" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">fix_annotations</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">corrections</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dryrun</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#recon.operations.corrections.fix_annotations" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Fix annotations in a copy of List[Example] data.</p>
<p>This function will NOT add annotations to your data.
It will only remove erroneous annotations and fix the
labels for specific spans.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>example</code></td>
        <td><code>Example</code></td>
        <td><p>Input Example</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>corrections</code></td>
        <td><code>Dict[str, str]</code></td>
        <td><p>Dictionary of corrections mapping entity text to a new label.
If the value is set to None, the annotation will be removed</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>case_sensitive</code></td>
        <td><code>bool</code></td>
        <td><p>Consider case of text for each correction</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>dryrun</code></td>
        <td><code>bool</code></td>
        <td><p>Treat corrections as a dryrun and just print all changes to be made</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Example</code></td>
      <td><p>Example with fixed annotations</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/corrections.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@operation</span><span class="p">(</span><span class="s2">&quot;recon.v1.fix_annotations&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">fix_annotations</span><span class="p">(</span>
    <span class="n">example</span><span class="p">:</span> <span class="n">Example</span><span class="p">,</span>
    <span class="n">corrections</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Correction</span><span class="p">],</span>
    <span class="n">case_sensitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">dryrun</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Example</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Fix annotations in a copy of List[Example] data.</span>

<span class="sd">    This function will NOT add annotations to your data.</span>
<span class="sd">    It will only remove erroneous annotations and fix the</span>
<span class="sd">    labels for specific spans.</span>

<span class="sd">    Args:</span>
<span class="sd">        example (Example): Input Example</span>
<span class="sd">        corrections (Dict[str, str]): Dictionary of corrections mapping entity text to a new label.</span>
<span class="sd">            If the value is set to None, the annotation will be removed</span>
<span class="sd">        case_sensitive (bool, optional): Consider case of text for each correction</span>
<span class="sd">        dryrun (bool, optional): Treat corrections as a dryrun and just print all changes to be made</span>

<span class="sd">    Returns:</span>
<span class="sd">        Example: Example with fixed annotations</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">case_sensitive</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">corrections</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">annotation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="n">corrections_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Correction</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">corrections</span><span class="p">}</span>
    <span class="n">prints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">ents_to_remove</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">spans</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">case_sensitive</span> <span class="k">else</span> <span class="n">s</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">corrections_map</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">corrections_map</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">to_label</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">from_labels</span> <span class="ow">or</span> <span class="s2">&quot;ANY&quot;</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">from_labels</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">dryrun</span><span class="p">:</span>
                    <span class="n">prints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deleting span: </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ents_to_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">from_labels</span> <span class="ow">or</span> <span class="s2">&quot;ANY&quot;</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">from_labels</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">dryrun</span><span class="p">:</span>
                    <span class="n">prints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Correction span: </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2"> from labels: </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">from_labels</span><span class="si">}</span><span class="s2"> to label: </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">to_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">to_label</span><span class="p">)</span>

    <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ents_to_remove</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">ents_to_remove</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">example</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">dryrun</span><span class="p">:</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">divider</span><span class="p">(</span><span class="s2">&quot;Example Text&quot;</span><span class="p">)</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">prints</span><span class="p">:</span>
            <span class="n">msg</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">example</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="recon.operations.corrections.rename_labels" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">rename_labels</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">label_map</span><span class="p">)</span></code>


<a href="#recon.operations.corrections.rename_labels" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Rename labels in a copy of List[Example] data</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>example</code></td>
        <td><code>Example</code></td>
        <td><p>Input Example</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>label_map</code></td>
        <td><code>Dict[str, str]</code></td>
        <td><p>One-to-one mapping of label names</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Example</code></td>
      <td><p>Copy of Example with renamed labels</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/corrections.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@operation</span><span class="p">(</span><span class="s2">&quot;recon.v1.rename_labels&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">rename_labels</span><span class="p">(</span><span class="n">example</span><span class="p">:</span> <span class="n">Example</span><span class="p">,</span> <span class="n">label_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Example</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Rename labels in a copy of List[Example] data</span>

<span class="sd">    Args:</span>
<span class="sd">        example (Example): Input Example</span>
<span class="sd">        label_map (Dict[str, str]): One-to-one mapping of label names</span>

<span class="sd">    Returns:</span>
<span class="sd">        Example: Copy of Example with renamed labels</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">span</span> <span class="ow">in</span> <span class="n">example</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
        <span class="n">span</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">span</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">example</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="recon.operations.corrections.split_sentences" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">split_sentences</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">preprocessed_outputs</span><span class="o">=</span><span class="p">{})</span></code>


<a href="#recon.operations.corrections.split_sentences" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Split a single example into multiple examples by splitting the text into
multiple sentences and resetting entity and token offsets based on offsets
relative to sentence boundaries</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>example</code></td>
        <td><code>Example</code></td>
        <td><p>Input Example</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>preprocessed_outputs</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>Outputs of preprocessors.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Example]</code></td>
      <td><p>List of split examples.
    Could be list of 1 if the example is just one sentence.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/corrections.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@operation</span><span class="p">(</span><span class="s2">&quot;recon.v1.split_sentences&quot;</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;recon.v1.spacy&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">split_sentences</span><span class="p">(</span><span class="n">example</span><span class="p">:</span> <span class="n">Example</span><span class="p">,</span> <span class="n">preprocessed_outputs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Example</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Split a single example into multiple examples by splitting the text into</span>
<span class="sd">    multiple sentences and resetting entity and token offsets based on offsets</span>
<span class="sd">    relative to sentence boundaries</span>

<span class="sd">    Args:</span>
<span class="sd">        example (Example): Input Example</span>
<span class="sd">        preprocessed_outputs (Dict[str, Any], optional): Outputs of preprocessors.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Example]: List of split examples.</span>
<span class="sd">            Could be list of 1 if the example is just one sentence.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">preprocessed_outputs</span><span class="p">[</span><span class="s2">&quot;recon.v1.spacy&quot;</span><span class="p">]</span>

    <span class="n">new_examples</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ents</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">example</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
        <span class="n">span</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">char_span</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">ent</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">span</span><span class="p">:</span>
            <span class="n">token</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="n">ent</span><span class="o">.</span><span class="n">start</span> <span class="p">:</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="n">text</span><span class="p">:</span>
                    <span class="n">token</span> <span class="o">=</span> <span class="n">t</span>
            <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
                <span class="n">span</span> <span class="o">=</span> <span class="n">SpacySpan</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">ent</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="n">ents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>

    <span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="o">=</span> <span class="n">ents</span>

    <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">sents</span><span class="p">:</span>
        <span class="n">sent_doc</span> <span class="o">=</span> <span class="n">sent</span><span class="o">.</span><span class="n">as_doc</span><span class="p">()</span>
        <span class="n">new_example</span> <span class="o">=</span> <span class="n">Example</span><span class="p">(</span>
            <span class="n">text</span><span class="o">=</span><span class="n">sent</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
            <span class="n">spans</span><span class="o">=</span><span class="p">[</span>
                <span class="n">Span</span><span class="p">(</span>
                    <span class="n">text</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                    <span class="n">start</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">start_char</span><span class="p">,</span>
                    <span class="n">end</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">end_char</span><span class="p">,</span>
                    <span class="n">token_start</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
                    <span class="n">token_end</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">label_</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">sent_doc</span><span class="o">.</span><span class="n">ents</span>
            <span class="p">],</span>
            <span class="n">tokens</span><span class="o">=</span><span class="p">[</span><span class="n">Token</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">text</span><span class="p">),</span> <span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sent_doc</span><span class="p">)],</span>
        <span class="p">)</span>
        <span class="n">new_examples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_examples</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="recon.operations.corrections.strip_annotations" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">strip_annotations</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">strip_chars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;!&#39;</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">],</span> <span class="n">preprocessed_outputs</span><span class="o">=</span><span class="p">{})</span></code>


<a href="#recon.operations.corrections.strip_annotations" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Strip punctuation and spaces from start and end of annotations.
These characters are almost always a mistake and will confuse a model</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>example</code></td>
        <td><code>Example</code></td>
        <td><p>Input Example</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>strip_chars</code></td>
        <td><code>List[str]</code></td>
        <td><p>Characters to strip.</p></td>
        <td><code>[&#39;.&#39;, &#39;!&#39;, &#39;?&#39;, &#39;-&#39;, &#39;:&#39;, &#39; &#39;]</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Example</code></td>
      <td><p>Example with stripped spans</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/corrections.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@operation</span><span class="p">(</span><span class="s2">&quot;recon.v1.strip_annotations&quot;</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;recon.v1.spacy&quot;</span><span class="p">],</span> <span class="n">handles_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">strip_annotations</span><span class="p">(</span>
    <span class="n">example</span><span class="p">:</span> <span class="n">Example</span><span class="p">,</span>
    <span class="n">strip_chars</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;!&quot;</span><span class="p">,</span> <span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">],</span>
    <span class="n">preprocessed_outputs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Example</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Strip punctuation and spaces from start and end of annotations.</span>
<span class="sd">    These characters are almost always a mistake and will confuse a model</span>

<span class="sd">    Args:</span>
<span class="sd">        example (Example): Input Example</span>
<span class="sd">        strip_chars (List[str], optional): Characters to strip.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Example: Example with stripped spans</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">preprocessed_outputs</span><span class="p">[</span><span class="s2">&quot;recon.v1.spacy&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">fix_tokens</span><span class="p">(</span><span class="n">example</span><span class="p">:</span> <span class="n">Example</span><span class="p">,</span> <span class="n">span</span><span class="p">:</span> <span class="n">Span</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">fix_tokens</span> <span class="o">=</span> <span class="n">example</span><span class="o">.</span><span class="n">tokens</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">tokens</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">fix_tokens</span> <span class="ow">and</span> <span class="n">span</span><span class="o">.</span><span class="n">token_start</span> <span class="ow">and</span> <span class="n">span</span><span class="o">.</span><span class="n">token_end</span> <span class="ow">and</span> <span class="n">span</span><span class="o">.</span><span class="n">token_start</span> <span class="o">&lt;</span> <span class="n">span</span><span class="o">.</span><span class="n">token_end</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">example</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">strip_chars</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">ch</span><span class="p">):</span>
                <span class="n">ch</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">while</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">strip_chars</span><span class="p">:</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">ch</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">ch</span><span class="p">):</span>
                <span class="n">ch</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">while</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">strip_chars</span><span class="p">:</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">text</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">ch</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">end</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">example</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="recon.operations.tokenization" class="doc doc-heading">
        <code>tokenization</code>



<a href="#recon.operations.tokenization" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h3 id="recon.operations.tokenization.add_tokens" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">add_tokens</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">use_spacy_token_ends</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">preprocessed_outputs</span><span class="p">)</span></code>


<a href="#recon.operations.tokenization.add_tokens" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Add tokens to each Example</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>example</code></td>
        <td><code>Example</code></td>
        <td><p>Input Example</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>preprocessed_outputs</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>Outputs of preprocessors</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Example</code></td>
      <td><p>Example with tokens</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/tokenization.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@operation</span><span class="p">(</span><span class="s2">&quot;recon.v1.add_tokens&quot;</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;recon.v1.spacy&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">add_tokens</span><span class="p">(</span>
    <span class="n">example</span><span class="p">:</span> <span class="n">Example</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">use_spacy_token_ends</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">preprocessed_outputs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Example</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add tokens to each Example</span>

<span class="sd">    Args:</span>
<span class="sd">        example (Example): Input Example</span>
<span class="sd">        preprocessed_outputs (Dict[str, Any]): Outputs of preprocessors</span>

<span class="sd">    Returns:</span>
<span class="sd">        Example: Example with tokens</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">preprocessed_outputs</span><span class="p">[</span><span class="s2">&quot;recon.v1.spacy&quot;</span><span class="p">]</span>

    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">token_starts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">token_ends</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">idx</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Token</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">i</span><span class="p">))</span>
        <span class="n">token_starts</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
        <span class="n">token_ends</span><span class="p">[</span><span class="n">end</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>

    <span class="n">example</span><span class="o">.</span><span class="n">tokens</span> <span class="o">=</span> <span class="n">tokens</span>

    <span class="k">for</span> <span class="n">span</span> <span class="ow">in</span> <span class="n">example</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">start</span> <span class="ow">in</span> <span class="n">token_starts</span> <span class="ow">and</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span> <span class="ow">in</span> <span class="n">token_ends</span><span class="p">:</span>
            <span class="n">span</span><span class="o">.</span><span class="n">token_start</span> <span class="o">=</span> <span class="n">token_starts</span><span class="p">[</span><span class="n">span</span><span class="o">.</span><span class="n">start</span><span class="p">]</span><span class="o">.</span><span class="n">i</span>
            <span class="k">if</span> <span class="n">use_spacy_token_ends</span><span class="p">:</span>
                <span class="n">span</span><span class="o">.</span><span class="n">token_end</span> <span class="o">=</span> <span class="n">token_ends</span><span class="p">[</span><span class="n">span</span><span class="o">.</span><span class="n">end</span><span class="p">]</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">span</span><span class="o">.</span><span class="n">token_end</span> <span class="o">=</span> <span class="n">token_ends</span><span class="p">[</span><span class="n">span</span><span class="o">.</span><span class="n">end</span><span class="p">]</span><span class="o">.</span><span class="n">i</span>

        <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">token_start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">span</span><span class="o">.</span><span class="n">token_end</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">example</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="recon.operations.tokenization.fix_tokenization_and_spacing" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">fix_tokenization_and_spacing</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">preprocessed_outputs</span><span class="o">=</span><span class="p">{})</span></code>


<a href="#recon.operations.tokenization.fix_tokenization_and_spacing" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Fix tokenization and spacing issues where there are annotation spans that
don't fall on a token boundary. This can happen if annotations are done at the
character level, not the token level. Often, when scraping web text it's easy to
get two words pushed together where one is an entity so this can fix a lot of issues.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>example</code></td>
        <td><code>Example</code></td>
        <td><p>Input Example</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>preprocessed_outputs</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>Outputs of preprocessors</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Example</code></td>
      <td><p>Example with spans fixed to align to token boundaries.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/tokenization.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@operation</span><span class="p">(</span><span class="s2">&quot;recon.v1.fix_tokenization_and_spacing&quot;</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;recon.v1.spacy&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">fix_tokenization_and_spacing</span><span class="p">(</span>
    <span class="n">example</span><span class="p">:</span> <span class="n">Example</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">preprocessed_outputs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Example</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Fix tokenization and spacing issues where there are annotation spans that</span>
<span class="sd">    don&#39;t fall on a token boundary. This can happen if annotations are done at the</span>
<span class="sd">    character level, not the token level. Often, when scraping web text it&#39;s easy to</span>
<span class="sd">    get two words pushed together where one is an entity so this can fix a lot of issues.</span>

<span class="sd">    Args:</span>
<span class="sd">        example (Example): Input Example</span>
<span class="sd">        preprocessed_outputs (Dict[str, Any]): Outputs of preprocessors</span>

<span class="sd">    Returns:</span>
<span class="sd">        Example: Example with spans fixed to align to token boundaries.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">doc</span> <span class="o">=</span> <span class="n">preprocessed_outputs</span><span class="p">[</span><span class="s2">&quot;recon.v1.spacy&quot;</span><span class="p">]</span>

    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">token_starts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">token_ends</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">idx</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Token</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">i</span><span class="p">))</span>
        <span class="n">token_starts</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
        <span class="n">token_ends</span><span class="p">[</span><span class="n">end</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>

    <span class="n">spans_to_increment</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">span_i</span><span class="p">,</span> <span class="n">span</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">spans</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">start</span> <span class="ow">in</span> <span class="n">token_starts</span> <span class="ow">and</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span> <span class="ow">in</span> <span class="n">token_ends</span><span class="p">:</span>
            <span class="c1"># Aligns to token boundaries, nothing to change here</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">start</span> <span class="ow">in</span> <span class="n">token_starts</span> <span class="ow">and</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">token_ends</span><span class="p">:</span>
            <span class="c1"># Span start aligns to token_start but end doesn&#39;t</span>
            <span class="c1"># e.g. [customer][PERSONTYPE]s but should be annotated as [customers][PERSONTYPE]</span>
            <span class="c1"># tokenization_errors.append((example, span))</span>
            <span class="c1"># print(&quot;BAD END&quot;)</span>
            <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">in</span> <span class="n">token_ends</span><span class="p">:</span>
                <span class="c1"># Likely off by 1 annotation</span>
                <span class="c1"># e.g. [customer][PERSONTYPE]s but should be annotated as [customers][PERSONTYPE]</span>
                <span class="n">span</span><span class="o">.</span><span class="n">end</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">span</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">example</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="n">span</span><span class="o">.</span><span class="n">start</span> <span class="p">:</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
                <span class="c1"># print(&quot;SPAN CORRECTED OFF BY 1&quot;, example.text, span)</span>
            <span class="k">elif</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">in</span> <span class="n">token_ends</span><span class="p">:</span>
                <span class="n">span</span><span class="o">.</span><span class="n">end</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="n">span</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">example</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="n">span</span><span class="o">.</span><span class="n">start</span> <span class="p">:</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Likely bad tokenization</span>
                <span class="c1"># e.g. [Quadling][GPE]Country should be split to [Quadling][GPE] Country</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">span_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">spans</span><span class="p">)):</span>
                    <span class="n">spans_to_increment</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">fe_text</span> <span class="o">=</span> <span class="n">example</span><span class="o">.</span><span class="n">text</span>

                <span class="n">split_start</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="n">start</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">spans_to_increment</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">span_i</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">(</span><span class="n">spans_to_increment</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">split_start</span> <span class="o">+=</span> <span class="n">spans_to_increment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">span_i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">split_end</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">spans_to_increment</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">span_i</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">(</span><span class="n">spans_to_increment</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">split_end</span> <span class="o">+=</span> <span class="n">spans_to_increment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">span_i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">new_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fe_text</span><span class="p">[:</span><span class="n">split_start</span><span class="p">]</span><span class="si">}{</span><span class="n">span</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">fe_text</span><span class="p">[</span><span class="n">split_end</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span>

                <span class="n">example</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">new_text</span>

        <span class="k">elif</span> <span class="n">span</span><span class="o">.</span><span class="n">start</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">token_starts</span> <span class="ow">and</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span> <span class="ow">in</span> <span class="n">token_ends</span><span class="p">:</span>
            <span class="c1"># Bad tokenization</span>
            <span class="c1"># e.g. with[Raymond][PERSON] but text should be split to with [Raymond][PERSON]</span>
            <span class="c1"># print(&quot;BAD START&quot;, span.text)</span>
            <span class="c1"># tokenization_errors.append((example, span))</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">span_i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">spans</span><span class="p">)):</span>
                <span class="n">spans_to_increment</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">fe_text</span> <span class="o">=</span> <span class="n">example</span><span class="o">.</span><span class="n">text</span>

            <span class="n">split_start</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="n">start</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">spans_to_increment</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">span_i</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">(</span><span class="n">spans_to_increment</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">split_start</span> <span class="o">+=</span> <span class="n">spans_to_increment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">span_i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">split_end</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">spans_to_increment</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">span_i</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">(</span><span class="n">spans_to_increment</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">split_end</span> <span class="o">+=</span> <span class="n">spans_to_increment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">span_i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

            <span class="n">new_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fe_text</span><span class="p">[:</span><span class="n">split_start</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">span</span><span class="o">.</span><span class="n">text</span><span class="si">}{</span><span class="n">fe_text</span><span class="p">[</span><span class="n">split_end</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">example</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">new_text</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Something is super messed up.</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SPAN CORRECTED OFF BY 1 unfixable&quot;</span><span class="p">,</span> <span class="n">example</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">span</span><span class="p">)</span>
            <span class="n">span</span><span class="o">.</span><span class="n">start</span>
            <span class="n">span</span><span class="o">.</span><span class="n">end</span>
            <span class="c1"># tokenization_errors.append((example, span))</span>

            <span class="c1"># if (before &gt;= 0 and after &lt; len(span.text) and span[before] not in token_starts and span[before] != &#39; &#39; and span[after] not in token_ends and span[after] != &#39; &#39;):</span>
            <span class="c1">#     fe_text = example.text</span>
            <span class="c1">#     new_text = f&quot;{fe_text[:span.start]} {span.text}{fe_text[span.end:]}&quot;</span>
            <span class="c1">#     spans_to_increment[span_i] += 1</span>
            <span class="c1">#     for j in range(span_i + 1, len(example.spans)):</span>
            <span class="c1">#         spans_to_increment[j] += 2</span>
            <span class="c1"># else:</span>
            <span class="c1"># unfixable_examples.add(example.text)</span>
            <span class="c1"># break</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># Increment the start and end characters for each span</span>
    <span class="k">for</span> <span class="n">span_i</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">spans_to_increment</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">example</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="n">span_i</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="o">+=</span> <span class="n">count</span>
        <span class="n">example</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="n">span_i</span><span class="p">]</span><span class="o">.</span><span class="n">end</span> <span class="o">+=</span> <span class="n">count</span>

    <span class="k">return</span> <span class="n">example</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="recon.operations.utils" class="doc doc-heading">
        <code>utils</code>



<a href="#recon.operations.utils" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">











  <div class="doc doc-object doc-function">



<h3 id="recon.operations.utils.create_response_field" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_response_field</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">class_validators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">model_config</span><span class="o">=&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pydantic</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">BaseConfig</span><span class="s1">&#39;&gt;, field_info=None, alias=None)</span></code>


<a href="#recon.operations.utils.create_response_field" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Create a new response field. Raises if type_ is invalid.</p>

        <details class="quote">
          <summary>Source code in <code>recon/operations/utils.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">create_response_field</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">type_</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">class_validators</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Validator</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">required</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">UndefinedType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">model_config</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">BaseConfig</span><span class="p">]</span> <span class="o">=</span> <span class="n">BaseConfig</span><span class="p">,</span>
    <span class="n">field_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FieldInfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">alias</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModelField</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new response field. Raises if type_ is invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">class_validators</span> <span class="o">=</span> <span class="n">class_validators</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="n">field_info</span> <span class="o">=</span> <span class="n">field_info</span> <span class="ow">or</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="n">response_field</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
        <span class="n">ModelField</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">type_</span><span class="o">=</span><span class="n">type_</span><span class="p">,</span>
        <span class="n">class_validators</span><span class="o">=</span><span class="n">class_validators</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
        <span class="n">required</span><span class="o">=</span><span class="n">required</span><span class="p">,</span>
        <span class="n">model_config</span><span class="o">=</span><span class="n">model_config</span><span class="p">,</span>
        <span class="n">alias</span><span class="o">=</span><span class="n">alias</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">response_field</span><span class="p">(</span><span class="n">field_info</span><span class="o">=</span><span class="n">field_info</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid args for response field! Hint: check that </span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2"> is a valid pydantic field type&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-function">



<h3 id="recon.operations.utils.get_received_operation_data" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_received_operation_data</span><span class="p">(</span><span class="n">required_params</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span></code>


<a href="#recon.operations.utils.get_received_operation_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Resolve serialized args and kwargs data of an operation to their Pydantic types</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>required_params</code></td>
        <td><code>Dict[str, ModelField]</code></td>
        <td><p>Mapping of field name to Pydantic ModelField for
required parameters of the callable</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>state</code></td>
        <td><code>OperationState</code></td>
        <td><p>Operation state including serialized args and kwargs data</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict[str, Any]</code></td>
      <td><p>Kwargs mapping of deserialized params to pass to the operation</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/utils.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_received_operation_data</span><span class="p">(</span><span class="n">required_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ModelField</span><span class="p">],</span> <span class="n">state</span><span class="p">:</span> <span class="n">OperationState</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Resolve serialized args and kwargs data of an operation to their Pydantic types</span>

<span class="sd">    Args:</span>
<span class="sd">        required_params (Dict[str, ModelField]): Mapping of field name to Pydantic ModelField for</span>
<span class="sd">            required parameters of the callable</span>
<span class="sd">        state (OperationState): Operation state including serialized args and kwargs data</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, Any]: Kwargs mapping of deserialized params to pass to the operation</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">filled_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">received_data</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">kwargs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">required_params</span><span class="p">:</span>
                <span class="n">received_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
                <span class="n">filled_keys</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">required_params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="n">filled_keys</span> <span class="ow">and</span> <span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">arg_idx</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="p">):</span>
            <span class="n">param_field</span> <span class="o">=</span> <span class="n">required_params</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">required_params</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">arg_idx</span><span class="p">]]</span>
            <span class="n">received_data</span><span class="p">[</span><span class="n">param_field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg</span>

    <span class="k">return</span> <span class="n">received_data</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="recon.operations.utils.get_required_operation_params" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_required_operation_params</span><span class="p">(</span><span class="n">op</span><span class="p">)</span></code>


<a href="#recon.operations.utils.get_required_operation_params" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get required typed parameters for an operation</p>
<p>Based on logic for JSON resolution to Pydantic types implemented by FastAPI
Reference: https://github.com/tiangolo/fastapi/blob/master/fastapi/dependencies/utils.py</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>op</code></td>
        <td><code>Callable</code></td>
        <td><p>Inner Callable of a recon operation</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict[str, ModelField]</code></td>
      <td><p>Mapping of field name to Pydantic ModelField for
    required parameters of the callable</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/utils.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_required_operation_params</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ModelField</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get required typed parameters for an operation</span>

<span class="sd">    Based on logic for JSON resolution to Pydantic types implemented by FastAPI</span>
<span class="sd">    Reference: https://github.com/tiangolo/fastapi/blob/master/fastapi/dependencies/utils.py</span>

<span class="sd">    Args:</span>
<span class="sd">        op (Callable): Inner Callable of a recon operation</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, ModelField]: Mapping of field name to Pydantic ModelField for</span>
<span class="sd">            required parameters of the callable</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">endpoint_signature</span> <span class="o">=</span> <span class="n">get_typed_signature</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
    <span class="n">signature_params</span> <span class="o">=</span> <span class="n">endpoint_signature</span><span class="o">.</span><span class="n">parameters</span>

    <span class="n">required_params</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">signature_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">param_name</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;example&quot;</span><span class="p">,</span> <span class="s2">&quot;preprocessed_outputs&quot;</span><span class="p">}:</span>
            <span class="c1"># All operations accept an example and potentially a special</span>
            <span class="c1"># preprocessed_outputs parameter if the operation requires</span>
            <span class="c1"># batched example preprocessing to function. We don&#39;t</span>
            <span class="c1"># need to include these in dynamic param resolution as they are</span>
            <span class="c1"># already handled by the internals of the operation</span>
            <span class="k">continue</span>

        <span class="n">param_field</span> <span class="o">=</span> <span class="n">get_param_field</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">default_field_info</span><span class="o">=</span><span class="n">FieldInfo</span><span class="p">,</span> <span class="n">param_name</span><span class="o">=</span><span class="n">param_name</span><span class="p">)</span>
        <span class="n">required_params</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">param_field</span>

    <span class="k">return</span> <span class="n">required_params</span>
</code></pre></div>
        </details>
    </div>

  </div>











  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="recon.operations.validation" class="doc doc-heading">
        <code>validation</code>



<a href="#recon.operations.validation" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h3 id="recon.operations.validation.filter_overlaps" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">filter_overlaps</span><span class="p">(</span><span class="n">example</span><span class="p">)</span></code>


<a href="#recon.operations.validation.filter_overlaps" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Filter overlapping entity spans by picking the longest one.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>example</code></td>
        <td><code>Example</code></td>
        <td><p>Input Example</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Example]</code></td>
      <td><p>Example with fixed overlaps</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/validation.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@operation</span><span class="p">(</span><span class="s2">&quot;recon.v1.filter_overlaps&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">filter_overlaps</span><span class="p">(</span><span class="n">example</span><span class="p">:</span> <span class="n">Example</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Example</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Filter overlapping entity spans by picking the longest one.</span>

<span class="sd">    Args:</span>
<span class="sd">        example (Example): Input Example</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Example]: Example with fixed overlaps</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annotations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">spans</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
    <span class="n">filtered_annotations</span> <span class="o">=</span> <span class="n">remove_overlapping_entities</span><span class="p">(</span><span class="n">annotations</span><span class="p">)</span>
    <span class="n">example</span><span class="o">.</span><span class="n">spans</span> <span class="o">=</span> <span class="n">filtered_annotations</span>

    <span class="k">return</span> <span class="n">example</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="recon.operations.validation.remove_overlapping_entities" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">remove_overlapping_entities</span><span class="p">(</span><span class="n">sorted_spans</span><span class="p">)</span></code>


<a href="#recon.operations.validation.remove_overlapping_entities" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Removes overlapping entities from the entity set, by greedilytaking the longest
entity from each overlapping chain. The input list of entities should be sorted
and follow the spacy format.</p>

        <details class="quote">
          <summary>Source code in <code>recon/operations/validation.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">remove_overlapping_entities</span><span class="p">(</span><span class="n">sorted_spans</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes overlapping entities from the entity set, by greedilytaking the longest</span>
<span class="sd">    entity from each overlapping chain. The input list of entities should be sorted</span>
<span class="sd">    and follow the spacy format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">spans_without_overlap</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">current_overlapping_chain</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">current_overlapping_chain_start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">current_overlapping_chain_end</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">current_entity</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sorted_spans</span><span class="p">):</span>
        <span class="n">current_entity</span> <span class="o">=</span> <span class="n">sorted_spans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">current_entity_start</span> <span class="o">=</span> <span class="n">current_entity</span><span class="o">.</span><span class="n">start</span>
        <span class="n">current_entity_end</span> <span class="o">=</span> <span class="n">current_entity</span><span class="o">.</span><span class="n">end</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_overlapping_chain</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">current_overlapping_chain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_entity</span><span class="p">)</span>
            <span class="n">current_overlapping_chain_start</span> <span class="o">=</span> <span class="n">current_entity_start</span>
            <span class="n">current_overlapping_chain_end</span> <span class="o">=</span> <span class="n">current_entity_end</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">min_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">current_entity_end</span><span class="p">,</span> <span class="n">current_overlapping_chain_end</span><span class="p">)</span>
            <span class="n">max_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">current_entity_start</span><span class="p">,</span> <span class="n">current_overlapping_chain_start</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">min_end</span> <span class="o">-</span> <span class="n">max_start</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">current_overlapping_chain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_entity</span><span class="p">)</span>
                <span class="n">current_overlapping_chain_start</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">current_entity_start</span><span class="p">,</span> <span class="n">current_overlapping_chain_start</span><span class="p">)</span>
                <span class="n">current_overlapping_chain_end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">current_entity_end</span><span class="p">,</span> <span class="n">current_overlapping_chain_end</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">selections_from_chain</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]</span> <span class="o">=</span> <span class="n">select_subset_of_overlapping_chain</span><span class="p">(</span><span class="n">current_overlapping_chain</span><span class="p">)</span>

                <span class="n">current_overlapping_chain</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">spans_without_overlap</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">selections_from_chain</span><span class="p">)</span>
                <span class="n">current_overlapping_chain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_entity</span><span class="p">)</span>
                <span class="n">current_overlapping_chain_start</span> <span class="o">=</span> <span class="n">current_entity_start</span>
                <span class="n">current_overlapping_chain_end</span> <span class="o">=</span> <span class="n">current_entity_end</span>

    <span class="n">spans_without_overlap</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">select_subset_of_overlapping_chain</span><span class="p">(</span><span class="n">current_overlapping_chain</span><span class="p">))</span>

    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">spans_without_overlap</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="recon.operations.validation.select_subset_of_overlapping_chain" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">select_subset_of_overlapping_chain</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span></code>


<a href="#recon.operations.validation.select_subset_of_overlapping_chain" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Select the subset of entities in an overlapping chain to return by greedily choosing the
longest entity in the chain until there are no entities remaining</p>

        <details class="quote">
          <summary>Source code in <code>recon/operations/validation.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">select_subset_of_overlapping_chain</span><span class="p">(</span><span class="n">chain</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Select the subset of entities in an overlapping chain to return by greedily choosing the</span>
<span class="sd">    longest entity in the chain until there are no entities remaining</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sorted_chain</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">chain</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">selections_from_chain</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">chain_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># dump the current chain by greedily keeping the longest entity that doesn&#39;t overlap</span>
    <span class="k">while</span> <span class="n">chain_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_chain</span><span class="p">):</span>
        <span class="n">entity</span> <span class="o">=</span> <span class="n">sorted_chain</span><span class="p">[</span><span class="n">chain_index</span><span class="p">]</span>
        <span class="n">match_found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">already_selected_entity</span> <span class="ow">in</span> <span class="n">selections_from_chain</span><span class="p">:</span>
            <span class="n">max_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">entity</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">already_selected_entity</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
            <span class="n">min_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">entity</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">already_selected_entity</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">max_start</span><span class="p">,</span> <span class="n">min_end</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">match_found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">match_found</span><span class="p">:</span>
            <span class="n">selections_from_chain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>

        <span class="n">chain_index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">selections_from_chain</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="recon.operations.validation.upcase_labels" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">upcase_labels</span><span class="p">(</span><span class="n">example</span><span class="p">)</span></code>


<a href="#recon.operations.validation.upcase_labels" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Convert all span labels to uppercase to normalize</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>example</code></td>
        <td><code>Example</code></td>
        <td><p>Input Example</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Example</code></td>
      <td><p>Example with fixed labels</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>recon/operations/validation.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="nd">@operation</span><span class="p">(</span><span class="s2">&quot;recon.v1.upcase_labels&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">upcase_labels</span><span class="p">(</span><span class="n">example</span><span class="p">:</span> <span class="n">Example</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Example</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Convert all span labels to uppercase to normalize</span>

<span class="sd">    Args:</span>
<span class="sd">        example (Example): Input Example</span>

<span class="sd">    Returns:</span>
<span class="sd">        Example: Example with fixed labels</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">example</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
        <span class="n">s</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">example</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../loaders/" title="Loaders" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Loaders
              </div>
            </div>
          </a>
        
        
          <a href="../stats/" title="Stats" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Stats
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/kabirkhan/recon" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/kabir_khan14" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.2d1db4bd.min.js"></script>
      <script src="../../assets/javascripts/bundle.6627ddf3.min.js"></script><script id="__lang" type="application/json">{"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../js/termynal.js"></script>
      
        <script src="https://unpkg.com/mermaid@8.4.6/dist/mermaid.min.js"></script>
      
        <script src="../../js/custom.js"></script>
      
    
  </body>
</html>